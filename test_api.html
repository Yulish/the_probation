import requests
import json
import base64
from io import BytesIO
from PIL import Image

def generate_base64():
img = Image.new('RGB', (1, 1), color='red')
buffer = BytesIO()
img.save(buffer, format='JPEG')
buffer.seek(0)
img_base64 = base64.b64encode(buffer.getvalue()).decode('utf-8')
return img_base64

data = {
"user": {
"email": "me@yandex.com",
"phone": "+799912347",
"fam": "Пользователь",
"name": "Тест",
"otc": ""
},
"location": {
"beautyTitle": "Красивое название", # Добавлено (обязательно в модели)
"title": "Тестовый перевал",
"other_titles": "Другой титул",
"connect": "", # Добавлено (обязательно) - из "data" в вашем JSON
"coordinates": {
"latitude": 55.7558,
"longitude": 37.6173,
"height": 0 # Добавлено (по умолчанию, модель требует)
},
"level": {
"winter": "1A",
"summer": "1A",
"autumn": "1A",
"spring": "1A"
},
"add_time": "2023-01-01T12:00:00Z",
"status": "new"
},
"images": [
{
"data": generate_base64(),
"title": "Тестовое фото"
}
]
}

url = "http://127.0.0.1:8000/api/submitData/"

try:
response = requests.post(url, json=data)
print(f"Статус ответа: {response.status_code}")
print(f"Ответ сервера: {response.json()}")

if response.status_code == 200 and response.json().get("success"):
    print("✅ УСПЕХ: Данные отправлены и сохранены! Проверьте админ-панель Django.")
else:
    print("❌ ОШИБКА: Проверьте детали выше. Возможно, модель требует другие поля.")
except Exception as e:
print(f"Ошибка при отправке: {e}")


